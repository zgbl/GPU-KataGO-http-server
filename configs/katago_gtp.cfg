# KataGo GTP Configuration for HTTP Server
# 整合版配置 - 优化用于HTTP API服务

# === 基本设置 ===
logDir = /app/logs
logAllGTPCommunication = true
logSearchInfo = false
logToStderr = false

# === 搜索设置 ===
# 适中的搜索强度，平衡性能和响应时间
maxVisits = 1600
maxPlayouts = 10000
maxTime = 10.0

# 根据GPU性能调整线程数
numSearchThreads = 6

# === 神经网络设置 ===
# GPU批处理大小 - 根据显存调整
nnMaxBatchSize = 16
nnCacheSizePowerOfTwo = 20
nnMutexPoolSizePowerOfTwo = 16
nnRandomize = true
nnPolicyTemperature = 1.0

# === 搜索参数 ===
cpuctExploration = 1.0
cpuctExplorationLog = 0.45
fpuReductionMax = 0.2
rootFpuReductionMax = 0.1
valueWeightExponent = 0.5
rootEndingBonusPoints = 0.5
rootPruneUselessMoves = true

# === 规则设置 ===
# 使用统一的规则设置，避免与单独规则项冲突
rules = tromp-taylor

# === 时间控制 ===
lagBuffer = 1.0
searchFactorAfterOnePass = 0.5
searchFactorAfterTwoPass = 0.25

# === 分析设置 ===
analysisWideRootNoise = 0.04
analysisIgnorePreRootHistory = false
analysisAssumeMultipleStartingBlackMovesAreHandicap = true
analysisTreePLCap = 500

# === GPU设置 ===
# 注意：某些版本可能不支持这些参数
# openclUseFP16 = false
# cudaUseFP16 = false
# cudaUseNHWC = false

# === 性能优化 ===
numNNServerThreadsPerModel = 2

# === GTP特定设置 ===
allowResignation = true
resignThreshold = -0.90
resignConsecTurns = 3

# === 输出格式 ===
reportAnalysisWinratesAs = BLACK
reportDuringSearchEvery = 0.5